(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{608:function(t,s,a){"use strict";a.r(s);var n=a(29),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[t._v("在阅读源码前，需要了解vue的构建工具, vue源码使用的是rollup作为构建vue包的基础工具，那么我们来看看rollup的基础用法吧。\n")]),t._v(" "),a("h3",{attrs:{id:"_1-基本配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-基本配置"}},[t._v("#")]),t._v(" 1. 基本配置")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    input"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 输入包位置")]),t._v("\n    external"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("external"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 标识外部包")]),t._v("\n    plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// flow是一个编译参考库将弱类型的js加上强类型的限制.")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alias")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aliases"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alias"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 和webpack 的插件机制类似，将源码通过插件的形式进行处理")]),t._v("\n    output"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导出的文件")]),t._v("\n      format"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导出的格式 cmd Amd Commonjs格式")]),t._v("\n      banner"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("banner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自述文件")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" opts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("moduleName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vue'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmd模式下 golobal 的名字")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onwarn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("Circular")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当编译异常时的报错信息")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br")])]),a("h3",{attrs:{id:"_2-模式-命令行模式-配置模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-模式-命令行模式-配置模式"}},[t._v("#")]),t._v(" 2.  模式 命令行模式 配置模式")]),t._v(" "),a("blockquote",[a("p",[t._v("在程序里面，从命令行中读取配置称为命令行模式，在代码中写入配置文件称之为配置模式, 大部分软件都会有这两种模式，来进行处理。但我们通常使用配置模式。")])]),t._v(" "),a("h4",{attrs:{id:"_2-1-核心配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-核心配置"}},[t._v("#")]),t._v(" 2.1 核心配置")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("输入(input -i/--input)")]),t._v(" "),a("blockquote",[a("p",[t._v("入口文件, 与webpack 等打包工具类似, 表示一个程序的入口。")])])]),t._v(" "),a("li",[a("p",[t._v("文件(file -o/--output.file")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("String")]),t._v(" 要写入的文件。也可用于生成 sourcemaps，如果适用")])])]),t._v(" "),a("li",[a("p",[t._v("格式(format -f/--output.format)")]),t._v(" "),a("blockquote",[a("p",[t._v("包模式, "),a("strong",[t._v("cjs")]),t._v(", "),a("strong",[t._v("amd")]),t._v(", "),a("strong",[t._v("esm")]),t._v(" "),a("strong",[t._v("iife")]),t._v(" "),a("strong",[t._v("umd")]),t._v(" "),a("strong",[t._v("system")]),t._v(" "),a("a",{attrs:{href:"https://juejin.cn/post/6870141103958589454#heading-14",target:"_blank",rel:"noopener noreferrer"}},[t._v("包模式"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("p",[t._v("生成包名称(name -n/--name)")]),t._v(" "),a("blockquote",[a("p",[t._v("String 变量名，代表你的 iife/umd 包，同一页上的其他脚本可以访问它。")])])]),t._v(" "),a("li",[a("p",[t._v("插件(plugins)")]),t._v(" "),a("blockquote",[a("p",[t._v("函数式插件，插件对象 数组 Array (或一个插件对象) – 有关详细信息请参阅 "),a("a",{attrs:{href:"https://www.rollupjs.com/guide/plugin-development",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件入门"),a("OutboundLink")],1),t._v("。记住要调用导入的插件函数(即 commonjs(), 而不是 commonjs).")])])]),t._v(" "),a("li",[a("p",[t._v("外链(external -e/--external)")]),t._v(" "),a("blockquote",[a("p",[t._v("外部包，在使用时, 会把相应的包给剔除主包")])])]),t._v(" "),a("li",[a("p",[t._v("全局模块(globals -g/--globals)")])])]),t._v(" "),a("h4",{attrs:{id:"_2-2-高级配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-高级配置"}},[t._v("#")]),t._v(" 2.2 高级配置")]),t._v(" "),a("ol",[a("li",[t._v("路径(paths)")]),t._v(" "),a("li",[t._v("banner/footer")]),t._v(" "),a("li",[t._v("intro/outro")]),t._v(" "),a("li",[t._v("缓存(cache)")]),t._v(" "),a("li",[t._v("onwarn")]),t._v(" "),a("li",[t._v("sourcemap -m/--sourcemap")])]),t._v(" "),a("h4",{attrs:{id:"_2-3-谨慎使用配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-谨慎使用配置"}},[t._v("#")]),t._v(" 2.3 谨慎使用配置")]),t._v(" "),a("ol",[a("li",[t._v("treeshake")]),t._v(" "),a("li",[t._v("acorn")]),t._v(" "),a("li",[t._v("context")]),t._v(" "),a("li",[t._v("moduleContext")]),t._v(" "),a("li",[t._v("legacy")]),t._v(" "),a("li",[t._v("exports")]),t._v(" "),a("li",[t._v("amd")]),t._v(" "),a("li",[t._v("indent")]),t._v(" "),a("li",[t._v("strict")])]),t._v(" "),a("h4",{attrs:{id:"_2-4-wacth-option"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-wacth-option"}},[t._v("#")]),t._v(" 2.4 wacth option")]),t._v(" "),a("ol",[a("li",[t._v("watch.chokidar")]),t._v(" "),a("li",[t._v("watch.include")]),t._v(" "),a("li",[t._v("watch.exclude")])]),t._v(" "),a("blockquote",[a("p",[t._v("上面的配置不一一描述，我们只需要有这样的概念即可,rollup 是一个构件通用包的工具，通过配置文件内容, 解析成相应包文件, 你使用在不同的平台，就打相应的包文件，另外可能提供一些插件处理一些特定的逻辑, watch 提供开发时的配置，来进行热加载与更新。这个也是我们调试vue代码的核心。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);